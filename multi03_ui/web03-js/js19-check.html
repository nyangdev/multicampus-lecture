<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <style>
        #colorbox {
            width: 320px;
            height: 320px;
            position: relative;
        }

        #red, #yellow, #blue, #black {
            width: 150px;
            height: 150px;
            border: 1px solid black;
            position: absolute;
        }

        #yellow {left:160px;}
        #blue {top: 160px;}
        #black {left:160px; top:160px;}
    </style>

    <script>

        function allSelect(check) {
            // debugger
            const chks = document.getElementsByName("chk");

            for (let i = 0; i < chks.length; i++) {
                chks[i].checked = check;
            }
        }

        function sel() {
            const chks = document.getElementsByName("chk");

            function checkedLen(chks) {
                let count = 0;
                for (let i=0; i<chks.length; i++) {
                    if(chks[i].checked) {
                        count++;
                    }
                }
                return count;
            }

            if (checkedLen(chks) > 0) {
                for(let i=0; i<chks.length; i++) {
                    if(chks[i].checked) {
                        document.getElementById(chks[i].value).style.backgroundColor=chks[i].value;
                    } else {
                        document.getElementById(chks[i].value).style.backgroundColor="";
                    }
                }

                // 전체 선택 checkbox (name: all)가 자동으로 해제
                // 만일, 이름이 chk인 체크박스의 체크되어있는 갯수가 == 이름이 chk 체크박스 전체의 갯수와 같다면
                if(checkedLen(chks) ==  chks.length) {
                    // debugger
                    document.getElementsByName("all")[0].checked = true;
                } else {
                    // debugger
                    document.getElementsByName("all")[0].checked = false;
                }

            } else {
                clearDiv();
            }
        }

        function clearDiv() {
            const colorboxes = document.querySelectorAll("#colorbox > div"); // id colorbox인 애들 자식요소 div 가져오기.

            for (let i=0; i<colorboxes.length; i++) {
                colorboxes[i].style.backgroundColor="";
            }

            allSelect(false);
            document.getElementsByName("all")[0].checked = false;
        }

    </script>
</head>
<body>
    <!-- DOM : Document Object Model -> document (html로 이루어진 문서)를 object 형태로 사용 -->
    <div id="colorbox">
        <div id="red">red</div>
        <div id="yellow">yellow</div>
        <div id="blue">blue</div>
        <div id="black">black</div>
    </div>

    <div id ="base">
        <form>
            <input type="checkbox" name="all" onclick="allSelect(this.checked);">전체선택
            <br>
            <input type="checkbox" name="chk" value="red">빨강
            <br>
            <input type="checkbox" name="chk" value="yellow">노랑
            <br>
            <input type="checkbox" name="chk" value="blue">파랑
            <br>
            <input type="checkbox" name="chk" value="black">검정
            <br>
            <input type="button" value="선택" onclick="sel();">
            <input type="button" value="clear" onclick="clearDiv();">

        </form>
    </div>
</body>
</html>